a=0.8 
totalT=1 
numberOfTimeSteps=100 
dt=totalT/numberOfTimeSteps 
Deltax=0.01 
A2=zeros(numberOfTimeSteps,numberOfTimeSteps); 

for i=1:height(A2) 
A2(i,i)=1/dt 
end 

%A2 is defined 
%define a vector um where each element, umi, is the forward approx. for vince's 
%forward approximation at time set m 
%define a vector uref where each element, urefi, is vince's guesses normal 
%distribution  

um=[ 9.9871e-01, 9.9865e-01, 1.0086e+00, 9.9047e-01, 1.0306e+00,... 

9.7803e-01, 1.0151e+00, 9.9911e-01, 1.0211e+00, 1.0346e+00,... 

9.9355e-01, 1.0031e+00, 9.8826e-01, 9.9780e-01, 1.0007e+00,... 

1.0225e+00, 1.0129e+00, 9.9784e-01, 1.0231e+00, 1.0172e+00,... 

1.0186e+00, 9.9387e-01, 1.0234e+00, 1.0040e+00, 1.0003e+00,... 

9.8809e-01, 1.0097e+00, 9.9799e-01, 1.0138e+00, 1.0205e+00,... 

9.8613e-01, 1.0388e+00, 1.0221e+00, 9.8714e-01, 1.0211e+00,... 

9.8735e-01, 9.9450e-01, 9.7240e-01, 1.0125e+00, 9.8329e-01,... 

9.6575e-01, 9.5573e-01, 9.5464e-01, 8.7640e-01, 8.3929e-01,... 

7.9152e-01, 7.2753e-01, 6.7470e-01, 5.7727e-01, 5.1505e-01,... 

4.3791e-01, 3.4069e-01, 2.6074e-01, 2.1740e-01, 1.5904e-01,... 

1.1833e-01, 7.5923e-02, 5.6810e-02, 4.1225e-02, 2.6765e-02,... 

2.5608e-02, 3.1289e-02, 1.0052e-02, 8.0520e-03, -7.0547e-03,... 

-1.0486e-02, -1.1693e-03, 2.2948e-02, 1.7801e-02, 2.7540e-03,... 

7.4897e-03, 1.6006e-03, -4.8131e-03, 9.2067e-03, -1.2662e-02,... 

-6.2998e-04, 1.0925e-02, 1.4255e-03, 3.2996e-03, -2.3797e-02,... 

2.0749e-03, -6.1127e-03, -2.1318e-04, 2.0020e-03, 4.4720e-03,... 

2.0165e-02, -3.9128e-04, 1.3110e-02, -9.2113e-04, 1.4234e-02,... 

2.0111e-02, 3.7343e-02, 4.8293e-02, 6.2615e-02, 9.7636e-02,... 

1.2484e-01, 1.4344e-01, 2.0683e-01, 2.5605e-01, 2.9825e-01]; 

uref=[5.3802e-32, 5.9534e-31, 6.3244e-30, 6.4497e-29, 6.3146e-28, 5.9349e-27,... 

5.3551e-26, 4.6387e-25, 3.8574e-24, 3.0794e-23, 2.3601e-22, 1.7364e-21,... 

1.2265e-20, 8.3164e-20, 5.4136e-19, 3.3831e-18, 2.0297e-17, 1.1690e-16,... 

6.4634e-16, 3.4308e-15, 1.7482e-14, 8.5523e-14, 4.0164e-13, 1.8108e-12,... 

7.8376e-12, 3.2566e-11, 1.2991e-10, 4.9747e-10, 1.8288e-09, 6.4545e-09,... 

2.1869e-08, 7.1132e-08, 2.2212e-07, 6.6583e-07, 1.9162e-06, 5.2939e-06,... 

1.4041e-05, 3.5750e-05, 8.7387e-05, 2.0506e-04, 4.6196e-04, 9.9907e-04,... 

2.0743e-03, 4.1344e-03, 7.9110e-03, 1.4532e-02, 2.5627e-02, 4.3385e-02,... 

7.0512e-02, 1.1002e-01, 1.6479e-01, 2.3696e-01, 3.2712e-01, 4.3351e-01,... 

5.5154e-01, 6.7364e-01, 7.8986e-01, 8.8911e-01, 9.6079e-01, 9.9674e-01,... 

9.9268e-01, 9.4910e-01, 8.7115e-01, 7.6762e-01, 6.4934e-01, 5.2733e-01,... 

4.1111e-01, 3.0769e-01, 2.2108e-01, 1.5249e-01, 1.0098e-01, 6.4194e-02,... 

3.9177e-02, 2.2953e-02, 1.2910e-02, 6.9708e-03, 3.6134e-03, 1.7982e-03,... 

8.5905e-04, 3.9398e-04, 1.7347e-04, 7.3321e-05, 2.9752e-05, 1.1590e-05,... 

4.3343e-06, 1.5561e-06, 5.3632e-07, 1.7746e-07, 5.6368e-08, 1.7189e-08,... 

5.0320e-09, 1.4142e-09, 3.8156e-10, 9.8827e-11, 2.4574e-11, 5.8660e-12,... 

1.3443e-12, 2.9574e-13, 6.2460e-14, 1.2664e-14] 

delJdelum=[] 

for i=1:width(um) 
delJdelumi=2*Deltax*(um(i)-uref(i)) 
delJdelum=[delJdelum;delJdelumi] 
end 

lambdam=transpose(delJdelum)/transpose(A2) 
A1=zeros(numberOfTimeSteps,numberOfTimeSteps) 

for i=1:(height(A1)) 
A1(i,i)=-a*(1/Deltax) 
end 

for i=1:(height(A1)-1) 
A1(i,i+1)=-1/dt+a*(1/Deltax) 
end 

%A1 is defined 

for i=(numberOfTimeSteps-1):-1:1 
lambdai=transpose((-A1)*transpose(lambdam))/A2 
lamdam=lambdai 
end 

% This implementation was made by Rose Bittle